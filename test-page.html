<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste do Cadastro de Alunos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3>Teste do Sistema de Cadastro</h3>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <button id="testHealth" class="btn btn-primary me-2">Testar Health Check</button>
                            <button id="testList" class="btn btn-info me-2">Listar Alunos</button>
                            <button id="testCreate" class="btn btn-success">Criar Aluno Teste</button>
                        </div>
                        
                        <div id="results" class="mt-4">
                            <h5>Resultados:</h5>
                            <pre id="output" class="bg-light p-3 rounded" style="max-height: 400px; overflow-y: auto;"></pre>
                        </div>
                        
                        <div class="mt-4">
                            <h5>Formulário de Teste:</h5>
                            <form id="testForm">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nome" class="form-label">Nome do Aluno</label>
                                            <input type="text" class="form-control" id="nome" value="João Teste">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="nome_responsavel" class="form-label">Nome do Responsável</label>
                                            <input type="text" class="form-control" id="nome_responsavel" value="Maria Teste">
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="telefone" class="form-label">Telefone</label>
                                            <input type="text" class="form-control" id="telefone" value="(11) 99999-9999">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label for="email" class="form-label">Email</label>
                                            <input type="email" class="form-control" id="email" value="joao.teste@email.com">
                                        </div>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="endereco" class="form-label">Endereço</label>
                                    <input type="text" class="form-control" id="endereco" value="Rua Teste, 123">
                                </div>
                                <button type="submit" class="btn btn-primary">Cadastrar Aluno</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE_URL = 'http://localhost:3003/api';
        const output = document.getElementById('output');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
        }

        // Teste Health Check
        document.getElementById('testHealth').addEventListener('click', async () => {
            try {
                log('Testando health check...');
                const response = await fetch(`${API_BASE_URL}/health`);
                const data = await response.json();
                log(`✅ Health Check: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`❌ Erro no health check: ${error.message}`);
            }
        });

        // Teste Listar Alunos
        document.getElementById('testList').addEventListener('click', async () => {
            try {
                log('Listando alunos...');
                const response = await fetch(`${API_BASE_URL}/alunos`);
                const data = await response.json();
                log(`✅ Lista de alunos: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`❌ Erro ao listar alunos: ${error.message}`);
            }
        });

        // Teste Criar Aluno Rápido
        document.getElementById('testCreate').addEventListener('click', async () => {
            try {
                log('Criando aluno teste...');
                const alunoTeste = {
                    nome: 'Teste Rápido',
                    nome_responsavel: 'Responsável Teste',
                    telefone: '(11) 88888-8888',
                    email: 'teste@email.com',
                    endereco: 'Endereço Teste'
                };
                
                const response = await fetch(`${API_BASE_URL}/alunos`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(alunoTeste)
                });
                
                const data = await response.json();
                log(`✅ Aluno criado: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`❌ Erro ao criar aluno: ${error.message}`);
            }
        });

        // Formulário de teste
        document.getElementById('testForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            try {
                log('Enviando formulário...');
                const formData = {
                    nome: document.getElementById('nome').value,
                    nome_responsavel: document.getElementById('nome_responsavel').value,
                    telefone: document.getElementById('telefone').value,
                    email: document.getElementById('email').value,
                    endereco: document.getElementById('endereco').value
                };
                
                const response = await fetch(`${API_BASE_URL}/alunos`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                log(`✅ Formulário enviado com sucesso: ${JSON.stringify(data, null, 2)}`);
            } catch (error) {
                log(`❌ Erro no formulário: ${error.message}`);
            }
        });

        // Log inicial
        log('Página de teste carregada. Servidor deve estar em http://localhost:3003');
    </script>
</body>
</html>
